---
title: "aRt + ggplot: exploring radial visualizations"
author: "Ijeamaka Anyene"
output:
  xaringan::moon_reader:
    seal: false
    lib_dir: libs
    nature:
      ratio: 16:9
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r, libraries, include = FALSE}
library(ggplot2)
library(dplyr)
library(ggimage)
library(patchwork)
```

```{r, chunk-setup, include = FALSE}
knitr::opts_chunk$set(fig.retina = 3, 
                      warning = FALSE, 
                      message = FALSE)
```

# aRt + ggplot: exploring radial visualizations
### Ijeamaka Anyene
### RLadies Johannesburg & Tunis Meetup
### 2020/01/14

---

[@ijeamaka_a](https://twitter.com/ijeamaka_a)
[ijeamakaa/aRt_ggplot_slides]()
---
aRt: intersection of computation and art  
...but in #rstats

---
Explosion of art in p5 JS & d4JS & other technologies I am unfamiliar with, but this can also be done in {ggplot2}

---
.pull-left[
.center[**Computational Art**] <br>
```{r, echo = FALSE, fig.align='center'}
knitr::include_graphics("images/pattern_3.png")
```
]

.pull-right[
.center[**TidyTuesday: Data Visualization**] <br>
```{r, echo = FALSE, fig.align='center', out.width="90%"}
knitr::include_graphics("images/2020-16_avatar.png")
```
]

---
```{r, segment_tible, include=FALSE}
segment_tibble = tibble(
    x = c(0, 9.8),
    y = c(0.98, 1.02),
    text = c("x = 0 \ny = 1",
             "xend = 10 \nyend = 1"))
```

```{r, geom_segment, eval = FALSE, echo = TRUE}
ggplot() +
  geom_segment(aes(x = 0, xend = 10,
                   y = 1, yend = 1),
               size = 5)
```

```{r, plot_geom_segment, echo = FALSE, fig.align = "center", fig.width=10, fig.height=4}
ggplot() +
  geom_segment(aes(x = 0, xend = 10,
                   y = 1, yend = 1),
               size = 5) +
  geom_text(data = segment_tibble,
            aes(x = x, y = y, label = text),
            size = 5) +
  scale_y_continuous(limits = c(0.95, 1.05))
```


---
.pull-left[
```{r horizontal_segment}
ggplot() +
  geom_segment(aes(x = 0, xend = 10,
                   y = 1, yend = 1),
               size = 5)
```
]

.pull-right[
```{r coord_horizontal_segment}
ggplot() +
  geom_segment(aes(x = 0, xend = 10,
                   y = 1, yend = 1),
               size = 5) + 
  coord_polar() #<<
```
]

---
.pull-left[
```{r, vertical_segment}
ggplot() +
  geom_segment(aes(x = 5, xend = 5,
                   y = 1, yend = 10),
               size = 5) 
```
]

.pull-right[
```{r, coord_vertical_segment}
ggplot() +
  geom_segment(aes(x = 5, xend = 5,
                   y = 1, yend = 10),
               size = 5)  +
  coord_polar() #<<
```
]
---
### Computational Art
.pull-left[
```{r}
center_circle = tibble(
  x = seq(0, 19, by = .5),
  xend = x,
  y = rep(0, length(x)),
  yend = rep(3, length(x))
)

outer_circle = center_circle %>%
  mutate(y = yend,
         yend = yend + 6)
```
]

.pull-right[
**center circle segments**  
- x ranges from 0 to 19, in increments of .5  
- xend is equal to x (vertical lines)  
- y is 0
- yend is 3  
  
**outer circle segments**  
- x is the same
- xend is the same
- y is now 3
- yend is now 6
]
---
.pull-left[
```{r, comp_art, fig.show='hide'}
ggplot() +
  geom_segment(data = center_circle,
               aes(x = x, xend = xend,
                   y = y, yend = yend))
```
]

.pull-right[
![](`r knitr::fig_chunk("comp_art", "png")`)
]
---
.pull-left[
```{r, comp_art_1, fig.show='hide'}
ggplot() +
  geom_segment(data = center_circle,
               aes(x = x, xend = xend,
                   y = y, yend = yend)) +
  coord_polar()
```
]

.pull-right[
![](`r knitr::fig_chunk("comp_art_1", "png")`)
]

---
.pull-left[
```{r, comp_art_2, fig.show='hide'}
ggplot() +
  geom_segment(data = center_circle,
               aes(x = x, xend = xend,
                   y = y, yend = yend)) +
  geom_segment(data = outer_circle,
               aes(x = x, xend = xend,
                   y = y, yend = yend)) +
  coord_polar()
```
]

.pull-right[
![](`r knitr::fig_chunk("comp_art_2", "png")`)
]
---
.pull-left[
```{r, comp_art_3, fig.show='hide'}
ggplot() +
  geom_segment(data = center_circle,
               aes(x = x, xend = xend,
                   y = y, yend = yend),
               size = 0.5) + #<<
  geom_segment(data = outer_circle,
               aes(x = x, xend = xend,
                   y = y, yend = yend),
               size = 2) + #<< 
  coord_polar()
```
]
.pull-right[
![](`r knitr::fig_chunk("comp_art_3", "png")`)
]

---
.pull-left[
```{r, comp_art_4, fig.show='hide'}
ggplot() +
  geom_segment(data = center_circle,
               aes(x = x, xend = xend,
                   y = y, yend = yend),
               size = 0.5) + 
  geom_segment(data = outer_circle,
               aes(x = x, xend = xend,
                   y = y, yend = yend),
               size = 2) + 
  scale_y_continuous(limits = c(-2, 10)) + #<<
  coord_polar() 
```
]
.pull-right[
![](`r knitr::fig_chunk("comp_art_4", "png")`)
]
---
.pull-left[
```{r, comp_art_5, fig.show='hide'}
ggplot() +
  geom_segment(data = center_circle,
               aes(x = x, xend = xend,
                   y = y, yend = yend),
               size = 0.5) +
  geom_segment(data = outer_circle,
               aes(x = x, xend = xend,
                   y = y, yend = yend),
               size = 2) +
  scale_y_continuous(limits = c(-2, 10)) + 
  coord_polar() +
  theme( 
    panel.grid = element_blank(), #<<
    axis.title = element_blank(), #<<
    axis.text = element_blank(), #<<
    axis.ticks = element_blank() #<<
  )
```
]
.pull-right[
![](`r knitr::fig_chunk("comp_art_5", "png")`)
]
---
.pull-left[
```{r, comp_art_6, fig.show='hide'}
ggplot() +
  geom_segment(data = center_circle,
               aes(x = x, xend = xend,
                   y = y, yend = yend),
               size = 0.5,
               color = "white") + #<<
  geom_segment(data = outer_circle,
               aes(x = x, xend = xend,
                   y = y, yend = yend),
               size = 2,
               color = "white") + #<<
  scale_y_continuous(limits = c(-2, 10)) + 
  coord_polar() +
  theme(
    plot.background = element_rect( #<<
      fill = "#8a484a"), #<<
    panel.background = element_rect( #<<
      fill = "#8a484a"), #<<
    panel.grid = element_blank(),
    axis.title = element_blank(),
    axis.text = element_blank(),
    axis.ticks = element_blank()
  )
```
]
.pull-right[
![](`r knitr::fig_chunk("comp_art_6", "png")`)
]
---

.pull-left[
# Take the ideas from our computational art piece, and create the TidyTuesday Visualization
]

.pull-right[
```{r, echo = FALSE, fig.align='center', out.width="90%"}
knitr::include_graphics("images/2020-16_avatar.png")
```
]

---
.pull-left[
# Computational Art
You can create or generate your own *clean* data to create your visualization
]

.pull-right[
# Data Visualization
We often have to work with the data available to us.  
So first, we clean our data `r emo::ji("tool")`
]

---

# TidyTuesday 2020: Week 3 Avatar!

```{r, include = FALSE}
avatar = readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-08-11/avatar.csv')
```

```{r, echo = FALSE}
avatar %>%
  select(id, book, book_num, chapter, chapter_num, character) %>%
  head() %>%
  kableExtra::kable(format = "html")
```

---
```{r, echo = FALSE}
avatar %>%
  select(character, full_text) %>%
  head(n = 3) %>%
  kableExtra::kable(format = "html")
```

---
class: center, middle

```{r, echo = FALSE, fig.align="center", out.width="80%"}
knitr::include_graphics("images/avatar/appa.png")
```
## Who mentioned Appa and how many times per episode?

---
```{r, eval = FALSE, include = FALSE}
book_chapter = avatar %>%
  select(book_num, chapter_num) %>%
  unique() %>%
  mutate(chapter_seq = 1:length(chapter_num), 
         mention_max = rep(15, length(chapter_num)),
         images = if_else(book_num == 1, img[3],
                          if_else(book_num == 2, img[1],
                                  if_else(book_num == 3, img[2], "None"))))
```

```{r, eval = FALSE,include = FALSE}
appa_data = avatar %>%
  mutate(appa_mentions = stringr::str_count(full_text,
                                            "Appa")) %>%
  group_by(book_num, chapter_num, character) %>%
  summarise(appa_mentions_sum = sum(appa_mentions, na.rm = TRUE)) %>%
  filter(character != "Scene Description") %>%
  group_by(book_num, chapter_num) %>%
  top_n(n = 1, wt = appa_mentions_sum) %>%
  filter(appa_mentions_sum > 0)
```

```{r, eval = FALSE,include = FALSE}
appa_data_merged = 
  left_join(book_chapter, appa_data,
                             by = c("book_num" = "book_num",
                                    "chapter_num" = "chapter_num")) %>%
  mutate(appa_mentions_sum = case_when(
    is.na(appa_mentions_sum) == TRUE ~ as.double(0),
    is.na(appa_mentions_sum) == FALSE ~ as.double(appa_mentions_sum)),
    character = case_when(
      is.na(character) == TRUE ~ "None",
      TRUE ~ character),
    duplicate_episode = duplicated(chapter_seq)) 
```

```{r, eval = FALSE,include = FALSE}
# Combining names where there are duplicates
appa_data_merged$character[2] = "Aang & Katara"
appa_data_merged$character[13] = "Aang & Sokka"
appa_data_merged$character[35] = "Katara & Sokka"
appa_data_merged$character[55] = "Aang & Zuko"
appa_data_merged$character[59] = "Katara & Zuko"
appa_data_merged$character[65] = "Katara & Zuko"
```

```{r, eval = FALSE,include = FALSE}
appa_data_merged = appa_data_merged %>%
  filter(duplicate_episode == FALSE)
```

```{r, eval = FALSE,include = FALSE}
number_of_bar = nrow(appa_data_merged)
id = seq(1:number_of_bar)
angle = 90 - 360 * (id) / number_of_bar
appa_data_merged$angle = ifelse(angle < -90, angle+180, angle)
```

```{r, eval = FALSE,include = FALSE}
appa_img = c(here::here("data", "avatar", "appa.png"))
```


```{r, eval = FALSE,include = FALSE}
appa_plot = 
ggplot() +
  # Each chapter as a segment
  geom_segment(data = appa_data_merged,
               aes(x = chapter_seq,
                   xend = chapter_seq,
                   y = 0,
                   yend = appa_mentions_sum),
               size = 0.75) +
  # Adding dagged lines post segment
  geom_segment(data = appa_data_merged,
               aes(x = chapter_seq,
                   xend = chapter_seq,
                   y = appa_mentions_sum,
                   yend = mention_max), 
               linetype = "dotted",
               size = 1) +
  # Element icon to indicate a book
  geom_image(data = appa_data_merged,
             aes(x = chapter_seq,
                 y = 15 + 2, 
                 image = images),
             size = 0.03) +
  # Character names
  geom_text(data = appa_data_merged, 
            aes(x = chapter_seq,
                y = 31, 
                label = paste0(character, " ", book_num, ".",
                               chapter_num),
                angle = angle),
            size = 6.5, 
            family = "Lora") +
  # Adding inner circle line
  geom_segment(data = NULL,
               aes(x = 0, 
                   xend = 61,
                   y = 0,
                   yend = 0),
               size = 1) +
  # Appa Image
  geom_image(data = tibble(x = 30, y = -15, icon = appa_img),
             aes(x = x, y = y, image = icon),
             size = .25) +
  # Turning graph into circle
  ylim(-15,35) +
  coord_polar(start = 0) +
  
  # Everything else
  labs(title = "\nAppa: The Underdiscussed Hero of Avatar",
       subtitle = paste0("The character who most discusses Appa each episode", 
                         "\nis displayed with the book and chapter noted."),
       caption = paste0("Source: {appa} by Avery Robbins |", 
       " Appa: SadiesVinyl on Etsy |", 
       " Symbols: Howie62 on DeviantArt |", 
       " Visualization by @ijeamaka_a")) +
  theme(panel.background = element_rect(fill = "#e1d2c0"),
        plot.background = element_rect(fill = "#e1d2c0", 
                                       colour = "#0f0d0d", 
                                       size = 4),
        panel.grid = element_blank(),
        plot.title = element_text(hjust = 0.5, family = "Lora",
                                  face = "bold", size = 40),
        plot.subtitle = element_text(hjust = 0.5, family = "Lora",
                                     size = 25),
        plot.caption = element_text(size = 12),
        axis.text = element_blank(),
        axis.title = element_blank(),
        axis.ticks = element_blank())

appa_plot
```

